(function(){"use strict";var q,g,fe,j,me,be,ge,ye,Q,Y,Z,N={},ve=[],tt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,X=Array.isArray;function R(s,e){for(var t in e)s[t]=e[t];return s}function ee(s){s&&s.parentNode&&s.parentNode.removeChild(s)}function L(s,e,t){var n,i,r,o={};for(r in e)r=="key"?n=e[r]:r=="ref"?i=e[r]:o[r]=e[r];if(arguments.length>2&&(o.children=arguments.length>3?q.call(arguments,2):t),typeof s=="function"&&s.defaultProps!=null)for(r in s.defaultProps)o[r]===void 0&&(o[r]=s.defaultProps[r]);return $(s,o,n,i,null)}function $(s,e,t,n,i){var r={type:s,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++fe,__i:-1,__u:0};return i==null&&g.vnode!=null&&g.vnode(r),r}function D(s){return s.children}function H(s,e){this.props=s,this.context=e}function U(s,e){if(e==null)return s.__?U(s.__,s.__i+1):null;for(var t;e<s.__k.length;e++)if((t=s.__k[e])!=null&&t.__e!=null)return t.__e;return typeof s.type=="function"?U(s):null}function we(s){var e,t;if((s=s.__)!=null&&s.__c!=null){for(s.__e=s.__c.base=null,e=0;e<s.__k.length;e++)if((t=s.__k[e])!=null&&t.__e!=null){s.__e=s.__c.base=t.__e;break}return we(s)}}function Se(s){(!s.__d&&(s.__d=!0)&&j.push(s)&&!M.__r++||me!==g.debounceRendering)&&((me=g.debounceRendering)||be)(M)}function M(){for(var s,e,t,n,i,r,o,c=1;j.length;)j.length>c&&j.sort(ge),s=j.shift(),c=j.length,s.__d&&(t=void 0,i=(n=(e=s).__v).__e,r=[],o=[],e.__P&&((t=R({},n)).__v=n.__v+1,g.vnode&&g.vnode(t),te(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[i]:null,r,i??U(n),!!(32&n.__u),o),t.__v=n.__v,t.__.__k[t.__i]=t,Pe(r,t,o),t.__e!=i&&we(t)));M.__r=0}function Ce(s,e,t,n,i,r,o,c,a,u,p){var l,d,h,b,_,y,f=n&&n.__k||ve,m=e.length;for(a=nt(t,e,f,a,m),l=0;l<m;l++)(h=t.__k[l])!=null&&(d=h.__i===-1?N:f[h.__i]||N,h.__i=l,y=te(s,h,d,i,r,o,c,a,u,p),b=h.__e,h.ref&&d.ref!=h.ref&&(d.ref&&ne(d.ref,null,h),p.push(h.ref,h.__c||b,h)),_==null&&b!=null&&(_=b),4&h.__u||d.__k===h.__k?a=Oe(h,a,s):typeof h.type=="function"&&y!==void 0?a=y:b&&(a=b.nextSibling),h.__u&=-7);return t.__e=_,a}function nt(s,e,t,n,i){var r,o,c,a,u,p=t.length,l=p,d=0;for(s.__k=new Array(i),r=0;r<i;r++)(o=e[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(a=r+d,(o=s.__k[r]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?$(null,o,null,null,null):X(o)?$(D,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?$(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=s,o.__b=s.__b+1,c=null,(u=o.__i=st(o,t,a,l))!==-1&&(l--,(c=t[u])&&(c.__u|=2)),c==null||c.__v===null?(u==-1&&(i>p?d--:i<p&&d++),typeof o.type!="function"&&(o.__u|=4)):u!=a&&(u==a-1?d--:u==a+1?d++:(u>a?d--:d++,o.__u|=4))):s.__k[r]=null;if(l)for(r=0;r<p;r++)(c=t[r])!=null&&(2&c.__u)==0&&(c.__e==n&&(n=U(c)),Re(c,c));return n}function Oe(s,e,t){var n,i;if(typeof s.type=="function"){for(n=s.__k,i=0;n&&i<n.length;i++)n[i]&&(n[i].__=s,e=Oe(n[i],e,t));return e}s.__e!=e&&(e&&s.type&&!t.contains(e)&&(e=U(s)),t.insertBefore(s.__e,e||null),e=s.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function st(s,e,t,n){var i,r,o=s.key,c=s.type,a=e[t];if(a===null&&s.key==null||a&&o==a.key&&c===a.type&&(2&a.__u)==0)return t;if(n>(a!=null&&(2&a.__u)==0?1:0))for(i=t-1,r=t+1;i>=0||r<e.length;){if(i>=0){if((a=e[i])&&(2&a.__u)==0&&o==a.key&&c===a.type)return i;i--}if(r<e.length){if((a=e[r])&&(2&a.__u)==0&&o==a.key&&c===a.type)return r;r++}}return-1}function ke(s,e,t){e[0]=="-"?s.setProperty(e,t??""):s[e]=t==null?"":typeof t!="number"||tt.test(e)?t:t+"px"}function W(s,e,t,n,i){var r;e:if(e=="style")if(typeof t=="string")s.style.cssText=t;else{if(typeof n=="string"&&(s.style.cssText=n=""),n)for(e in n)t&&e in t||ke(s.style,e,"");if(t)for(e in t)n&&t[e]===n[e]||ke(s.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(ye,"$1")),e=e.toLowerCase()in s||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),s.l||(s.l={}),s.l[e+r]=t,t?n?t.u=n.u:(t.u=Q,s.addEventListener(e,r?Z:Y,r)):s.removeEventListener(e,r?Z:Y,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in s)try{s[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?s.removeAttribute(e):s.setAttribute(e,e=="popover"&&t==1?"":t))}}function Te(s){return function(e){if(this.l){var t=this.l[e.type+s];if(e.t==null)e.t=Q++;else if(e.t<t.u)return;return t(g.event?g.event(e):e)}}}function te(s,e,t,n,i,r,o,c,a,u){var p,l,d,h,b,_,y,f,m,S,C,A,T,V,J,et,z,_e,P=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(a=!!(32&t.__u),r=[c=e.__e=t.__e]),(p=g.__b)&&p(e);e:if(typeof P=="function")try{if(f=e.props,m="prototype"in P&&P.prototype.render,S=(p=P.contextType)&&n[p.__c],C=p?S?S.props.value:p.__:n,t.__c?y=(l=e.__c=t.__c).__=l.__E:(m?e.__c=l=new P(f,C):(e.__c=l=new H(f,C),l.constructor=P,l.render=rt),S&&S.sub(l),l.props=f,l.state||(l.state={}),l.context=C,l.__n=n,d=l.__d=!0,l.__h=[],l._sb=[]),m&&l.__s==null&&(l.__s=l.state),m&&P.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=R({},l.__s)),R(l.__s,P.getDerivedStateFromProps(f,l.__s))),h=l.props,b=l.state,l.__v=e,d)m&&P.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),m&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(m&&P.getDerivedStateFromProps==null&&f!==h&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(f,C),!l.__e&&(l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(f,l.__s,C)===!1||e.__v==t.__v)){for(e.__v!=t.__v&&(l.props=f,l.state=l.__s,l.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(F){F&&(F.__=e)}),A=0;A<l._sb.length;A++)l.__h.push(l._sb[A]);l._sb=[],l.__h.length&&o.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(f,l.__s,C),m&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(h,b,_)})}if(l.context=C,l.props=f,l.__P=s,l.__e=!1,T=g.__r,V=0,m){for(l.state=l.__s,l.__d=!1,T&&T(e),p=l.render(l.props,l.state,l.context),J=0;J<l._sb.length;J++)l.__h.push(l._sb[J]);l._sb=[]}else do l.__d=!1,T&&T(e),p=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++V<25);l.state=l.__s,l.getChildContext!=null&&(n=R(R({},n),l.getChildContext())),m&&!d&&l.getSnapshotBeforeUpdate!=null&&(_=l.getSnapshotBeforeUpdate(h,b)),z=(et=p!=null&&p.type===D&&p.key==null)?p.props.children:p,et&&(p.props.children=null),c=Ce(s,X(z)?z:[z],e,t,n,i,r,o,c,a,u),l.base=e.__e,e.__u&=-161,l.__h.length&&o.push(l),y&&(l.__E=l.__=null)}catch(F){if(e.__v=null,a||r!=null)if(F.then){for(e.__u|=a?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;r[r.indexOf(c)]=null,e.__e=c}else for(_e=r.length;_e--;)ee(r[_e]);else e.__e=t.__e,e.__k=t.__k;g.__e(F,e,t)}else r==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):c=e.__e=it(t.__e,e,t,n,i,r,o,a,u);return(p=g.diffed)&&p(e),128&e.__u?void 0:c}function Pe(s,e,t){for(var n=0;n<t.length;n++)ne(t[n],t[++n],t[++n]);g.__c&&g.__c(e,s),s.some(function(i){try{s=i.__h,i.__h=[],s.some(function(r){r.call(i)})}catch(r){g.__e(r,i.__v)}})}function it(s,e,t,n,i,r,o,c,a){var u,p,l,d,h,b,_,y=t.props,f=e.props,m=e.type;if(m=="svg"?i="http://www.w3.org/2000/svg":m=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((h=r[u])&&"setAttribute"in h==!!m&&(m?h.localName==m:h.nodeType==3)){s=h,r[u]=null;break}}if(s==null){if(m==null)return document.createTextNode(f);s=document.createElementNS(i,m,f.is&&f),c&&(g.__m&&g.__m(e,r),c=!1),r=null}if(m===null)y===f||c&&s.data===f||(s.data=f);else{if(r=r&&q.call(s.childNodes),y=t.props||N,!c&&r!=null)for(y={},u=0;u<s.attributes.length;u++)y[(h=s.attributes[u]).name]=h.value;for(u in y)if(h=y[u],u!="children"){if(u=="dangerouslySetInnerHTML")l=h;else if(!(u in f)){if(u=="value"&&"defaultValue"in f||u=="checked"&&"defaultChecked"in f)continue;W(s,u,null,h,i)}}for(u in f)h=f[u],u=="children"?d=h:u=="dangerouslySetInnerHTML"?p=h:u=="value"?b=h:u=="checked"?_=h:c&&typeof h!="function"||y[u]===h||W(s,u,h,y[u],i);if(p)c||l&&(p.__html===l.__html||p.__html===s.innerHTML)||(s.innerHTML=p.__html),e.__k=[];else if(l&&(s.innerHTML=""),Ce(e.type==="template"?s.content:s,X(d)?d:[d],e,t,n,m=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,o,r?r[0]:t.__k&&U(t,0),c,a),r!=null)for(u=r.length;u--;)ee(r[u]);c||(u="value",m=="progress"&&b==null?s.removeAttribute("value"):b!==void 0&&(b!==s[u]||m=="progress"&&!b||m=="option"&&b!==y[u])&&W(s,u,b,y[u],i),u="checked",_!==void 0&&_!==s[u]&&W(s,u,_,y[u],i))}return s}function ne(s,e,t){try{if(typeof s=="function"){var n=typeof s.__u=="function";n&&s.__u(),n&&e==null||(s.__u=s(e))}else s.current=e}catch(i){g.__e(i,t)}}function Re(s,e,t){var n,i;if(g.unmount&&g.unmount(s),(n=s.ref)&&(n.current&&n.current!==s.__e||ne(n,null,e)),(n=s.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(r){g.__e(r,e)}n.base=n.__P=null}if(n=s.__k)for(i=0;i<n.length;i++)n[i]&&Re(n[i],e,t||typeof s.type!="function");t||ee(s.__e),s.__c=s.__=s.__e=void 0}function rt(s,e,t){return this.constructor(s,t)}function K(s,e,t){var n,i,r,o;e==document&&(e=document.documentElement),g.__&&g.__(s,e),i=(n=typeof t=="function")?null:t&&t.__k||e.__k,r=[],o=[],te(e,s=(!n&&t||e).__k=L(D,null,[s]),i||N,N,e.namespaceURI,!n&&t?[t]:i?null:e.firstChild?q.call(e.childNodes):null,r,!n&&t?t:i?i.__e:e.firstChild,n,o),Pe(r,s,o)}function Ee(s,e){K(s,e,Ee)}function Ie(s,e,t){var n,i,r,o,c=R({},s.props);for(r in s.type&&s.type.defaultProps&&(o=s.type.defaultProps),e)r=="key"?n=e[r]:r=="ref"?i=e[r]:c[r]=e[r]===void 0&&o!==void 0?o[r]:e[r];return arguments.length>2&&(c.children=arguments.length>3?q.call(arguments,2):t),$(s.type,c,n||s.key,i||s.ref,null)}q=ve.slice,g={__e:function(s,e,t,n){for(var i,r,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(s)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(s,n||{}),o=i.__d),o)return i.__E=i}catch(c){s=c}throw s}},fe=0,H.prototype.setState=function(s,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=R({},this.state),typeof s=="function"&&(s=s(R({},t),this.props)),s&&R(t,s),s!=null&&this.__v&&(e&&this._sb.push(e),Se(this))},H.prototype.forceUpdate=function(s){this.__v&&(this.__e=!0,s&&this.__h.push(s),Se(this))},H.prototype.render=D,j=[],be=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ge=function(s,e){return s.__v.__b-e.__v.__b},M.__r=0,ye=/(PointerCapture)$|Capture$/i,Q=0,Y=Te(!1),Z=Te(!0);function se(){return(se=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s}).apply(this,arguments)}var ot=["context","children"];function ct(s){this.getChildContext=function(){return s.context};var e=s.children,t=function(n,i){if(n==null)return{};var r,o,c={},a=Object.keys(n);for(o=0;o<a.length;o++)i.indexOf(r=a[o])>=0||(c[r]=n[r]);return c}(s,ot);return Ie(e,t)}function at(){var s=new CustomEvent("_preact",{detail:{},bubbles:!0,cancelable:!0});this.dispatchEvent(s),this._vdom=L(ct,se({},this._props,{context:s.detail.context}),function e(t,n){if(t.nodeType===3)return t.data;if(t.nodeType!==1)return null;var i=[],r={},o=0,c=t.attributes,a=t.childNodes;for(o=c.length;o--;)c[o].name!=="slot"&&(r[c[o].name]=c[o].value,r[je(c[o].name)]=c[o].value);for(o=a.length;o--;){var u=e(a[o],null),p=a[o].slot;p?r[p]=L(Ae,{name:p},u):i[o]=u}var l=n?L(Ae,null,i):i;return L(n||t.nodeName.toLowerCase(),r,l)}(this,this._vdomComponent)),(this.hasAttribute("hydrate")?Ee:K)(this._vdom,this._root)}function je(s){return s.replace(/-(\w)/g,function(e,t){return t?t.toUpperCase():""})}function lt(s,e,t){if(this._vdom){var n={};n[s]=t=t??void 0,n[je(s)]=t,this._vdom=Ie(this._vdom,n),K(this._vdom,this._root)}}function ut(){K(this._vdom=null,this._root)}function Ae(s,e){var t=this;return L("slot",se({},s,{ref:function(n){n?(t.ref=n,t._listener||(t._listener=function(i){i.stopPropagation(),i.detail.context=e},n.addEventListener("_preact",t._listener))):t.ref.removeEventListener("_preact",t._listener)}}))}function ht(s,e,t,n){function i(){var r=Reflect.construct(HTMLElement,[],i);return r._vdomComponent=s,r._root=r,r}return(i.prototype=Object.create(HTMLElement.prototype)).constructor=i,i.prototype.connectedCallback=at,i.prototype.attributeChangedCallback=lt,i.prototype.disconnectedCallback=ut,t=t||s.observedAttributes||Object.keys(s.propTypes||{}),i.observedAttributes=t,t.forEach(function(r){Object.defineProperty(i.prototype,r,{get:function(){return this._vdom.props[r]},set:function(o){this._vdom?this.attributeChangedCallback(r,null,o):(this._props||(this._props={}),this._props[r]=o,this.connectedCallback());var c=typeof o;o!=null&&c!=="string"&&c!=="boolean"&&c!=="number"||this.setAttribute(r,o)}})}),customElements.define(e,i)}var dt=0;function O(s,e,t,n,i,r){e||(e={});var o,c,a=e;if("ref"in a)for(c in a={},e)c=="ref"?o=e[c]:a[c]=e[c];var u={type:s,props:a,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--dt,__i:-1,__u:0,__source:i,__self:r};if(typeof s=="function"&&(o=s.defaultProps))for(c in o)a[c]===void 0&&(a[c]=o[c]);return g.vnode&&g.vnode(u),u}var ie,v,re,Le,oe=0,Ue=[],w=g,xe=w.__b,qe=w.__r,Ne=w.diffed,$e=w.__c,De=w.unmount,Fe=w.__;function pt(s,e){w.__h&&w.__h(v,s,oe||e),oe=0;var t=v.__H||(v.__H={__:[],__h:[]});return s>=t.__.length&&t.__.push({}),t.__[s]}function ce(s){return oe=1,_t(Me,s)}function _t(s,e,t){var n=pt(ie++,2);if(n.t=s,!n.__c&&(n.__=[Me(void 0,e),function(c){var a=n.__N?n.__N[0]:n.__[0],u=n.t(a,c);a!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=v,!v.__f)){var i=function(c,a,u){if(!n.__c.__H)return!0;var p=n.__c.__H.__.filter(function(d){return!!d.__c});if(p.every(function(d){return!d.__N}))return!r||r.call(this,c,a,u);var l=n.__c.props!==c;return p.forEach(function(d){if(d.__N){var h=d.__[0];d.__=d.__N,d.__N=void 0,h!==d.__[0]&&(l=!0)}}),r&&r.call(this,c,a,u)||l};v.__f=!0;var r=v.shouldComponentUpdate,o=v.componentWillUpdate;v.componentWillUpdate=function(c,a,u){if(this.__e){var p=r;r=void 0,i(c,a,u),r=p}o&&o.call(this,c,a,u)},v.shouldComponentUpdate=i}return n.__N||n.__}function ft(){for(var s;s=Ue.shift();)if(s.__P&&s.__H)try{s.__H.__h.forEach(B),s.__H.__h.forEach(ae),s.__H.__h=[]}catch(e){s.__H.__h=[],w.__e(e,s.__v)}}w.__b=function(s){v=null,xe&&xe(s)},w.__=function(s,e){s&&e.__k&&e.__k.__m&&(s.__m=e.__k.__m),Fe&&Fe(s,e)},w.__r=function(s){qe&&qe(s),ie=0;var e=(v=s.__c).__H;e&&(re===v?(e.__h=[],v.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(B),e.__h.forEach(ae),e.__h=[],ie=0)),re=v},w.diffed=function(s){Ne&&Ne(s);var e=s.__c;e&&e.__H&&(e.__H.__h.length&&(Ue.push(e)!==1&&Le===w.requestAnimationFrame||((Le=w.requestAnimationFrame)||mt)(ft)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),re=v=null},w.__c=function(s,e){e.some(function(t){try{t.__h.forEach(B),t.__h=t.__h.filter(function(n){return!n.__||ae(n)})}catch(n){e.some(function(i){i.__h&&(i.__h=[])}),e=[],w.__e(n,t.__v)}}),$e&&$e(s,e)},w.unmount=function(s){De&&De(s);var e,t=s.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{B(n)}catch(i){e=i}}),t.__H=void 0,e&&w.__e(e,t.__v))};var He=typeof requestAnimationFrame=="function";function mt(s){var e,t=function(){clearTimeout(n),He&&cancelAnimationFrame(e),setTimeout(s)},n=setTimeout(t,100);He&&(e=requestAnimationFrame(t))}function B(s){var e=v,t=s.__c;typeof t=="function"&&(s.__c=void 0,t()),v=e}function ae(s){var e=v;s.__c=s.__(),v=e}function Me(s,e){return typeof e=="function"?e(s):e}function bt({label:s}){const[e,t]=ce(""),[n,i]=ce(""),[r,o]=ce("form"),c=async a=>{a.preventDefault();try{const u=await pb.collection("users").requestOTP(e);o("sent")}catch(u){i(u.message)}};return O(D,{children:[n&&O("div",{children:n}),r==="sent"&&O("div",{class:"flex flex-col items-center p-4",children:[O("div",{class:"flex items-center justify-center",children:O("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-10 text-primary",children:O("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 9v.906a2.25 2.25 0 0 1-1.183 1.981l-6.478 3.488M2.25 9v.906a2.25 2.25 0 0 0 1.183 1.981l6.478 3.488m8.839 2.51-4.66-2.51m0 0-1.023-.55a2.25 2.25 0 0 0-2.134 0l-1.022.55m0 0-4.661 2.51m16.5 1.615a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V8.844a2.25 2.25 0 0 1 1.183-1.981l7.5-4.039a2.25 2.25 0 0 1 2.134 0l7.5 4.039a2.25 2.25 0 0 1 1.183 1.98V19.5Z"})})}),O("p",{class:"text-center text-lg mt-4 font-bold",children:"Check your email!"}),O("p",{class:"text-center mt-4",children:"We emailed a magic link to:"}),O("p",{class:"text-center text-md font-bold",children:e})]}),r==="form"&&O("form",{onSubmit:a=>c(a),children:O("fieldset",{class:"fieldset",children:[O("label",{class:"fieldset-label",children:"Email"}),O("input",{type:"email",class:"input w-full",placeholder:"Email",onChange:a=>t(a.target.value),value:e}),O("button",{type:"submit",class:"btn btn-neutral mt-4",children:"Get Magic Link"})]})})]})}class k extends Error{constructor(e){var t,n,i,r;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,k.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof k||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(r=(i=(n=this.originalError)==null?void 0:n.cause)==null?void 0:i.message)!=null&&r.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const G=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function gt(s,e){const t={};if(typeof s!="string")return t;const n=Object.assign({},{}).decode||yt;let i=0;for(;i<s.length;){const r=s.indexOf("=",i);if(r===-1)break;let o=s.indexOf(";",i);if(o===-1)o=s.length;else if(o<r){i=s.lastIndexOf(";",r-1)+1;continue}const c=s.slice(i,r).trim();if(t[c]===void 0){let a=s.slice(r+1,o).trim();a.charCodeAt(0)===34&&(a=a.slice(1,-1));try{t[c]=n(a)}catch{t[c]=a}}i=o+1}return t}function We(s,e,t){const n=Object.assign({},t||{}),i=n.encode||vt;if(!G.test(s))throw new TypeError("argument name is invalid");const r=i(e);if(r&&!G.test(r))throw new TypeError("argument val is invalid");let o=s+"="+r;if(n.maxAge!=null){const c=n.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(c)}if(n.domain){if(!G.test(n.domain))throw new TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!G.test(n.path))throw new TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){if(!function(a){return Object.prototype.toString.call(a)==="[object Date]"||a instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function yt(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function vt(s){return encodeURIComponent(s)}const wt=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let Ke;function x(s){if(s)try{const e=decodeURIComponent(Ke(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Be(s,e=0){let t=x(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}Ke=typeof atob!="function"||wt?s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,i=0,r=0,o="";n=e.charAt(r++);~n&&(t=i%4?64*t+n:n,i++%4)?o+=String.fromCharCode(255&t>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o}:atob;const Ge="pb_auth";class le{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!Be(this.token)}get isSuperuser(){var t,n;let e=x(this.token);return e.type=="auth"&&(((t=this.record)==null?void 0:t.collectionName)=="_superusers"||!((n=this.record)!=null&&n.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),x(this.token).type=="auth"&&!this.isSuperuser}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Ge){const n=gt(e||"")[t]||"";let i={};try{i=JSON.parse(n),(typeof i===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.record||i.model||null)}exportToCookie(e,t=Ge){var a,u;const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},i=x(this.token);n.expires=i!=null&&i.exp?new Date(1e3*i.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const r={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let o=We(t,JSON.stringify(r),e);const c=typeof Blob<"u"?new Blob([o]).size:o.length;if(r.record&&c>4096){r.record={id:(a=r.record)==null?void 0:a.id,email:(u=r.record)==null?void 0:u.email};const p=["collectionId","collectionName","verified"];for(const l in this.record)p.includes(l)&&(r.record[l]=this.record[l]);o=We(t,JSON.stringify(r),e)}return o}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.record),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class St extends le{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,t){this._storageSet(this.storageKey,{token:e,record:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.record||t.model||null)})}}class E{constructor(e){this.client=e}}class Ct extends E{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,n,i){return i=Object.assign({method:"POST",body:{email:t,template:n,collection:e}},i),this.client.send("/api/settings/test/email",i).then(()=>!0)}async generateAppleClientSecret(e,t,n,i,r,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:i,duration:r}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}const Ot=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function ue(s){if(s){s.query=s.query||{};for(let e in s)Ot.includes(e)||(s.query[e]=s[e],delete s[e])}}function Ve(s){const e=[];for(const t in s){if(s[t]===null||s[t]===void 0)continue;const n=s[t],i=encodeURIComponent(t);if(Array.isArray(n))for(const r of n)e.push(i+"="+encodeURIComponent(r));else n instanceof Date?e.push(i+"="+encodeURIComponent(n.toISOString())):typeof n!==null&&typeof n=="object"?e.push(i+"="+encodeURIComponent(JSON.stringify(n))):e.push(i+"="+encodeURIComponent(n))}return e.join("&")}class Je extends E{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){var o;if(!e)throw new Error("topic must be set.");let i=e;if(n){ue(n=Object.assign({},n));const c="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));i+=(i.includes("?")?"&":"?")+c}const r=function(c){const a=c;let u;try{u=JSON.parse(a==null?void 0:a.data)}catch{}t(u||{})};return this.subscriptions[i]||(this.subscriptions[i]=[]),this.subscriptions[i].push(r),this.isConnected?this.subscriptions[i].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(i,r):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,r)}async unsubscribe(e){var n;let t=!1;if(e){const i=this.getSubscriptionsByTopic(e);for(let r in i)if(this.hasSubscriptionListeners(r)){for(let o of this.subscriptions[r])(n=this.eventSource)==null||n.removeEventListener(r,o);delete this.subscriptions[r],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var n;let t=!1;for(let i in this.subscriptions)if((i+"?").startsWith(e)){t=!0;for(let r of this.subscriptions[i])(n=this.eventSource)==null||n.removeEventListener(i,r);delete this.subscriptions[i]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var r;let n=!1;const i=this.getSubscriptionsByTopic(e);for(let o in i){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let c=!1;for(let a=this.subscriptions[o].length-1;a>=0;a--)this.subscriptions[o][a]===t&&(c=!0,delete this.subscriptions[o][a],this.subscriptions[o].splice(a,1),(r=this.eventSource)==null||r.removeEventListener(o,t));c&&(this.subscriptions[o].length||delete this.subscriptions[o],n||this.hasSubscriptionListeners(o)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,n;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let i in this.subscriptions)if((n=this.subscriptions[i])!=null&&n.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let i in n)for(let r of n[i])r(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new k(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[]}}}class ze extends E{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(i=>{var r;return i.items=((r=i.items)==null?void 0:r.map(o=>this.decode(o)))||[],i})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{var i;if(!((i=n==null?void 0:n.items)!=null&&i.length))throw new k({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}async getOne(e,t){if(!e)throw new k({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}async update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(i=>this.decode(i))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],i=async r=>this.getList(r,e||500,t).then(o=>{const c=o.items;return n=n.concat(c),c.length==o.perPage?i(r+1):n});return i(1)}}function I(s,e,t,n){const i=n!==void 0;return i||t!==void 0?i?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function he(s){var e;(e=s._resetAutoRefresh)==null||e.call(s)}class kt extends ze{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}async getList(e=1,t=30,n){return super.getList(e,t,n)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,n){return super.update(e,t,n).then(i=>{var r,o,c;if(((r=this.client.authStore.record)==null?void 0:r.id)===(i==null?void 0:i.id)&&(((o=this.client.authStore.record)==null?void 0:o.collectionId)===this.collectionIdOrName||((c=this.client.authStore.record)==null?void 0:c.collectionName)===this.collectionIdOrName)){let a=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,i);a&&(u.expand=Object.assign(a,i.expand)),this.client.authStore.save(this.client.authStore.token,u)}return i})}async delete(e,t){return super.delete(e,t).then(n=>{var i,r,o;return!n||((i=this.client.authStore.record)==null?void 0:i.id)!==e||((r=this.client.authStore.record)==null?void 0:r.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.record)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,t,n){let i;n=Object.assign({method:"POST",body:{identity:e,password:t}},n),this.isSuperusers&&(i=n.autoRefreshThreshold,delete n.autoRefreshThreshold,n.autoRefresh||he(this.client));let r=await this.client.send(this.baseCollectionPath+"/auth-with-password",n);return r=this.authResponse(r),i&&this.isSuperusers&&function(c,a,u,p){he(c);const l=c.beforeSend,d=c.authStore.record,h=c.authStore.onChange((b,_)=>{(!b||(_==null?void 0:_.id)!=(d==null?void 0:d.id)||(_!=null&&_.collectionId||d!=null&&d.collectionId)&&(_==null?void 0:_.collectionId)!=(d==null?void 0:d.collectionId))&&he(c)});c._resetAutoRefresh=function(){h(),c.beforeSend=l,delete c._resetAutoRefresh},c.beforeSend=async(b,_)=>{var S;const y=c.authStore.token;if((S=_.query)!=null&&S.autoRefresh)return l?l(b,_):{url:b,sendOptions:_};let f=c.authStore.isValid;if(f&&Be(c.authStore.token,a))try{await u()}catch{f=!1}f||await p();const m=_.headers||{};for(let C in m)if(C.toLowerCase()=="authorization"&&y==m[C]&&c.authStore.token){m[C]=c.authStore.token;break}return _.headers=m,l?l(b,_):{url:b,sendOptions:_}}}(this.client,i,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},n))),r}async authWithOAuth2Code(e,t,n,i,r,o,c){let a={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectURL:i,createData:r}};return a=I("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",a,o,c),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{};let n=null;t.urlCallback||(n=Qe(void 0));const i=new Je(this.client);function r(){n==null||n.close(),i.unsubscribe()}const o={},c=t.requestKey;return c&&(o.requestKey=c),this.listAuthMethods(o).then(a=>{var d;const u=a.oauth2.providers.find(h=>h.name===t.provider);if(!u)throw new k(new Error(`Missing or invalid provider "${t.provider}".`));const p=this.client.buildURL("/api/oauth2-redirect"),l=c?(d=this.client.cancelControllers)==null?void 0:d[c]:void 0;return l&&(l.signal.onabort=()=>{r()}),new Promise(async(h,b)=>{var _;try{await i.subscribe("@oauth2",async S=>{var A;const C=i.clientId;try{if(!S.state||C!==S.state)throw new Error("State parameters don't match.");if(S.error||!S.code)throw new Error("OAuth2 redirect error or missing code: "+S.error);const T=Object.assign({},t);delete T.provider,delete T.scopes,delete T.createData,delete T.urlCallback,(A=l==null?void 0:l.signal)!=null&&A.onabort&&(l.signal.onabort=null);const V=await this.authWithOAuth2Code(u.name,S.code,u.codeVerifier,p,t.createData,T);h(V)}catch(T){b(new k(T))}r()});const y={state:i.clientId};(_=t.scopes)!=null&&_.length&&(y.scope=t.scopes.join(" "));const f=this._replaceQueryParams(u.authURL+p,y);await(t.urlCallback||function(S){n?n.location.href=S:n=Qe(S)})(f)}catch(y){r(),b(new k(y))}})}).catch(a=>{throw r(),a})}async authRefresh(e,t){let n={method:"POST"};return n=I("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(i=>this.authResponse(i))}async requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=I("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",i).then(()=>!0)}async confirmPasswordReset(e,t,n,i,r){let o={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return o=I("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,i,r),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(e,t,n){let i={method:"POST",body:{email:e}};return i=I("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-verification",i).then(()=>!0)}async confirmVerification(e,t,n){let i={method:"POST",body:{token:e}};return i=I("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",i).then(()=>{const r=x(e),o=this.client.authStore.record;return o&&!o.verified&&o.id===r.id&&o.collectionId===r.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(e,t,n){let i={method:"POST",body:{newEmail:e}};return i=I("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",i).then(()=>!0)}async confirmEmailChange(e,t,n,i){let r={method:"POST",body:{token:e,password:t}};return r=I("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",r,n,i),this.client.send(this.baseCollectionPath+"/confirm-email-change",r).then(()=>{const o=x(e),c=this.client.authStore.record;return c&&c.id===o.id&&c.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return this.client.collection("_externalAuths").getFullList(Object.assign({},t,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,t,n){const i=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:t}));return this.client.collection("_externalAuths").delete(i.id,n).then(()=>!0)}async requestOTP(e,t){return t=Object.assign({method:"POST",body:{email:e}},t),this.client.send(this.baseCollectionPath+"/request-otp",t)}async authWithOTP(e,t,n){return n=Object.assign({method:"POST",body:{otpId:e,password:t}},n),this.client.send(this.baseCollectionPath+"/auth-with-otp",n).then(i=>this.authResponse(i))}async impersonate(e,t,n){(n=Object.assign({method:"POST",body:{duration:t}},n)).headers=n.headers||{},n.headers.Authorization||(n.headers.Authorization=this.client.authStore.token);const i=new Xe(this.client.baseURL,new le,this.client.lang),r=await i.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),n);return i.authStore.save(r==null?void 0:r.token,this.decode((r==null?void 0:r.record)||{})),i}_replaceQueryParams(e,t={}){let n=e,i="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),i=e.substring(e.indexOf("?")+1));const r={},o=i.split("&");for(const c of o){if(c=="")continue;const a=c.split("=");r[decodeURIComponent(a[0].replace(/\+/g," "))]=decodeURIComponent((a[1]||"").replace(/\+/g," "))}for(let c in t)t.hasOwnProperty(c)&&(t[c]==null?delete r[c]:r[c]=t[c]);i="";for(let c in r)r.hasOwnProperty(c)&&(i!=""&&(i+="&"),i+=encodeURIComponent(c.replace(/%20/g,"+"))+"="+encodeURIComponent(r[c].replace(/%20/g,"+")));return i!=""?n+"?"+i:n}}function Qe(s){if(typeof window>"u"||!(window!=null&&window.open))throw new k(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,i=window.innerHeight;e=e>n?n:e,t=t>i?i:t;let r=n/2-e/2,o=i/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+o+",left="+r+",resizable,menubar=no")}class Tt extends ze{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",t).then(()=>!0)}}class Pt extends E{async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}async getOne(e,t){if(!e)throw new k({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Rt extends E{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Et extends E{getUrl(e,t,n={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,t,n)}getURL(e,t,n={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(e.collectionId||e.collectionName)),i.push(encodeURIComponent(e.id)),i.push(encodeURIComponent(t));let r=this.client.buildURL(i.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const o=new URLSearchParams(n);r+=(r.includes("?")?"&":"?")+o}return r}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class It extends E{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,t)}getDownloadURL(e,t){return this.client.buildURL(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class jt extends E{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/crons/${encodeURIComponent(e)}`,t).then(()=>!0)}}function de(s){return typeof Blob<"u"&&s instanceof Blob||typeof File<"u"&&s instanceof File||s!==null&&typeof s=="object"&&s.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function pe(s){return s&&(s.constructor.name==="FormData"||typeof FormData<"u"&&s instanceof FormData)}function Ye(s){for(const e in s){const t=Array.isArray(s[e])?s[e]:[s[e]];for(const n of t)if(de(n))return!0}return!1}const At=/^[\-\.\d]+$/;function Ze(s){if(typeof s!="string")return s;if(s=="true")return!0;if(s=="false")return!1;if((s[0]==="-"||s[0]>="0"&&s[0]<="9")&&At.test(s)){let e=+s;if(""+e===s)return e}return s}class Lt extends E{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new Ut(this.requests,e)),this.subs[e]}async send(e){const t=new FormData,n=[];for(let i=0;i<this.requests.length;i++){const r=this.requests[i];if(n.push({method:r.method,url:r.url,headers:r.headers,body:r.json}),r.files)for(let o in r.files){const c=r.files[o]||[];for(let a of c)t.append("requests."+i+"."+o,a)}}return t.append("@jsonPayload",JSON.stringify({requests:n})),e=Object.assign({method:"POST",body:t},e),this.client.send("/api/batch",e)}}class Ut{constructor(e,t){this.requests=[],this.requests=e,this.collectionIdOrName=t}upsert(e,t){t=Object.assign({body:e||{}},t);const n={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(n,t),this.requests.push(n)}create(e,t){t=Object.assign({body:e||{}},t);const n={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(n,t),this.requests.push(n)}update(e,t,n){n=Object.assign({body:t||{}},n);const i={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(i,n),this.requests.push(i)}delete(e,t){t=Object.assign({},t);const n={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(n,t),this.requests.push(n)}prepareRequest(e,t){if(ue(t),e.headers=t.headers,e.json={},e.files={},t.query!==void 0){const i=Ve(t.query);i&&(e.url+=(e.url.includes("?")?"&":"?")+i)}let n=t.body;pe(n)&&(n=function(r){let o={};return r.forEach((c,a)=>{if(a==="@jsonPayload"&&typeof c=="string")try{let u=JSON.parse(c);Object.assign(o,u)}catch(u){console.warn("@jsonPayload error:",u)}else o[a]!==void 0?(Array.isArray(o[a])||(o[a]=[o[a]]),o[a].push(Ze(c))):o[a]=Ze(c)}),o}(n));for(const i in n){const r=n[i];if(de(r))e.files[i]=e.files[i]||[],e.files[i].push(r);else if(Array.isArray(r)){const o=[],c=[];for(const a of r)de(a)?o.push(a):c.push(a);if(o.length>0&&o.length==r.length){e.files[i]=e.files[i]||[];for(let a of o)e.files[i].push(a)}else if(e.json[i]=c,o.length>0){let a=i;i.startsWith("+")||i.endsWith("+")||(a+="+"),e.files[a]=e.files[a]||[];for(let u of o)e.files[a].push(u)}}else e.json[i]=r}}}class Xe{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=n,t?this.authStore=t:typeof window<"u"&&window.Deno?this.authStore=new le:this.authStore=new St,this.collections=new Tt(this),this.files=new Et(this),this.logs=new Pt(this),this.settings=new Ct(this),this.realtime=new Je(this),this.health=new Rt(this),this.backups=new It(this),this.crons=new jt(this)}get admins(){return this.collection("_superusers")}createBatch(){return new Lt(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new kt(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let i=t[n];switch(typeof i){case"boolean":case"number":i=""+i;break;case"string":i="'"+i.replace(/'/g,"\\'")+"'";break;default:i=i===null?"null":i instanceof Date?"'"+i.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(i).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",i)}return e}getFileUrl(e,t,n={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,t,n)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var n;let t=this.baseURL;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(n=window.location.origin)!=null&&n.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseURL),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildURL(e);if(this.beforeSend){const i=Object.assign({},await this.beforeSend(n,t));i.url!==void 0||i.options!==void 0?(n=i.url||n,t=i.options||t):Object.keys(i).length&&(t=i,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const i=Ve(t.query);i&&(n+=(n.includes("?")?"&":"?")+i),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async i=>{let r={};try{r=await i.json()}catch{}if(this.afterSend&&(r=await this.afterSend(i,r,t)),i.status>=400)throw new k({url:i.url,status:i.status,data:r});return r}).catch(i=>{throw new k(i)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=function(i){if(typeof FormData>"u"||i===void 0||typeof i!="object"||i===null||pe(i)||!Ye(i))return i;const r=new FormData;for(const o in i){const c=i[o];if(typeof c!="object"||Ye({data:c})){const a=Array.isArray(c)?c:[c];for(let u of a)r.append(o,u)}else{let a={};a[o]=c,r.append("@jsonPayload",JSON.stringify(a))}}return r}(t.body),ue(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||pe(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const i=new AbortController;this.cancelControllers[n]=i,t.signal=i.signal}return t}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}}window.pb=new Xe,(async()=>{const s=window.location.pathname;if(pb.authStore.token)if(s!=="/login"&&s!=="/logout")try{const e=await pb.collection(pb.authStore.record.collectionId).authRefresh()}catch{pb.authStore.clear()}else pb.authStore.clear()})(),ht(bt,"login-form",["label"])})();
